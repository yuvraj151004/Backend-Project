# app.py

from flask import Flask, request, jsonify
import sqlite3

app = Flask(__name__)

# Get all assistants
@app.route('/assistants', methods=['GET'])
def get_assistants():
    conn = sqlite3.connect('assistants.db')
    c = conn.cursor()
    c.execute("SELECT * FROM assistants")
    assistants = c.fetchall()
    conn.close()
    return jsonify(assistants)

# Create an assistant
@app.route('/assistants', methods=['POST'])
def create_assistant():
    data = request.get_json()
    conn = sqlite3.connect('assistants.db')
    c = conn.cursor()
    c.execute("INSERT INTO assistants (name, role, email, phone_number) VALUES (?, ?, ?, ?)",
              (data['name'], data['role'], data['email'], data['phone_number']))
    conn.commit()
    conn.close()
    return jsonify({"message": "Assistant created successfully"})

# Update an assistant
@app.route('/assistants/<int:id>', methods=['PATCH'])
def update_assistant(id):
    data = request.get_json()
    conn = sqlite3.connect('assistants.db')
    c = conn.cursor()
    c.execute("UPDATE assistants SET name=?, role=?, email=?, phone_number=? WHERE id=?",
              (data['name'], data['role'], data['email'], data['phone_number'], id))
    conn.commit()
    conn.close()
    return jsonify({"message": "Assistant updated successfully"})

# Delete an assistant
@app.route('/assistants/<int:id>', methods=['DELETE'])
def delete_assistant(id):
    conn = sqlite3.connect('assistants.db')
    c = conn.cursor()
    c.execute("DELETE FROM assistants WHERE id=?", (id,))
    conn.commit()
    conn.close()
    return jsonify({"message": "Assistant deleted successfully"})

if __name__ == '__main__':
    app.run(debug=True)
